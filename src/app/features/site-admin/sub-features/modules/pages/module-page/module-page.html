<div class="flex bg-white w-full h-full">
  <div class="flex-1 p-6">
    <h1 class="text-2xl mb-4 font-bold text-[#1D1D21]">Module Page</h1>
    <div class="my-3 flex justify-end">
      <button class="px-4 py-2 mr-2 bg-[#5363F9] text-white rounded" (click)="exportToExcel()">
        Export to Excel
      </button>
    </div>
    <div class="module-table">
      <table
        matSort
        (matSortChange)="announceSortChange($event)"
        mat-table
        [dataSource]="dataSource"
        class="mat-elevation-z8"
      >
        <ng-container matColumnDef="actions">
          <th mat-header-cell *matHeaderCellDef>Actions</th>
          <td mat-cell *matCellDef="let module">
            <span cdkDragHandle class="drag-handle mr-2" aria-label="Drag handle">
              <mat-icon>drag_indicator</mat-icon>
            </span>
         
            <button
              (click)="editModule(module.id)"
              mat-icon-button
              color="primary"
              aria-label="Edit module"
            >
              <mat-icon>edit</mat-icon>
            </button>
            
            <button
              (click)="cancelModule()"
              mat-icon-button
              color="warn"
              aria-label="Cancel module"
            >
              <mat-icon>cancel</mat-icon>
            </button>
            <button
              (click)="saveModule(module.id)"
              mat-icon-button
              color="warn"
              aria-label="Delete module"
            >
              <mat-icon>save</mat-icon>
            </button>
            
          </td>
        </ng-container>

        <ng-container matColumnDef="status">
          <th mat-header-cell *matHeaderCellDef>Status</th>
          <td mat-cell *matCellDef="let module">
            <mat-slide-toggle
              class="toggle"
              [checked]="module.status"
             
            ></mat-slide-toggle>
          </td>
        </ng-container>

        <ng-container matColumnDef="moduleName">
          <th
            mat-header-cell
            *matHeaderCellDef
            mat-sort-header
            sortActionDescription="Sort by module name"
          >
            Module Name
          </th>

          <td mat-cell *matCellDef="let module">
            @if (!isEditing()) {
            <ng-container>
              {{ module.moduleName }}
            </ng-container>
            } @if(isEditing()) {
            <ng-container>
              <mat-form-field appearance="outline" class="edit-field">
                <input matInput placeholder="Module name" />
              </mat-form-field>
            </ng-container>
            }
          </td>
        </ng-container>

        <ng-container matColumnDef="description">
          <th
            mat-header-cell
            *matHeaderCellDef
            mat-sort-header
            sortActionDescription="Sort by description"
          >
            Description
          </th>

          <td mat-cell *matCellDef="let module">
            @if (!isEditing()) {
            <ng-container>
              {{ module.description }}
            </ng-container>
            } @if(isEditing()) {
            <ng-container>
              <mat-form-field appearance="outline" class="edit-field">
                <input matInput placeholder="Description" />
              </mat-form-field>
            </ng-container>
            }
        </ng-container>

        <ng-container matColumnDef="icon">
          <th mat-header-cell *matHeaderCellDef>Icon</th>
          <td mat-cell *matCellDef="let module">
            <mat-icon class="module-icon">{{ module.icon }}</mat-icon>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>

        <tbody cdkDropList>
          <tr mat-row *matRowDef="let module; columns: displayedColumns" cdkDrag></tr>
        </tbody>
      </table>
    </div>
    <div class="flex items-center justify-between mt-4 px-3">
      <p class="text-sm text-[#182330] font-semibold">
        Showing 1 to 5 entries of {{ dataSource.data.length }} entries
      </p>
      <div>
        <mat-paginator
          [length]="dataSource.data.length"
          [pageSize]="5"
          [pageSizeOptions]="[5]"
          #paginator
          style="display: none"
        ></mat-paginator>

        <div class="flex justify-end items-center mt-4 space-x-4">
          <!-- Previous -->
          <button
            class="border border-[#CAC6D3] rounded"
            mat-icon-button
            (click)="paginator.previousPage()"
            [disabled]="paginator.hasPreviousPage() === false"
          >
            <mat-icon>chevron_left</mat-icon>
          </button>

          <!-- Current Page -->
          <span class="bg-[#6D7BFA] text-white px-3 py-1 rounded">{{
            paginator.pageIndex + 1
          }}</span>

          <!-- Next -->
          <button
            class="border border-[#CAC6D3] rounded"
            mat-icon-button
            (click)="paginator.nextPage()"
            [disabled]="paginator.hasNextPage() === false"
          >
            <mat-icon>chevron_right</mat-icon>
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
